---
import SiteLayout from '../../layouts/SiteLayout.astro'
import TournamentsListIsland from '../../components/TournamentsListIsland'
import { getLangCookie, resolveLang, setLangCookie, tServer } from '@/i18n'
import type { Lang } from '@/i18n'

const existingCookie = getLangCookie(Astro)
const lang: Lang = resolveLang({ url: Astro.url, req: Astro.request, cookie: existingCookie ?? undefined })
if (existingCookie !== lang) {
  setLangCookie(Astro, lang)
}

const pageTitle = tServer(lang, 'tournaments.pageTitle')
const heading = tServer(lang, 'tournaments.heading')
const createLabel = tServer(lang, 'actions.createTournament')
---
<SiteLayout title={pageTitle}>
  <section class="mx-auto max-w-5xl px-4 py-8">
    <h1 class="text-2xl font-semibold mb-4">{heading}</h1>
    <TournamentsListIsland client:only="react" lang={lang} />
    <div class="mt-6">
      <a href="/t/new" class="inline-flex items-center rounded-md border px-3 py-2 text-sm hover:bg-gray-50">
        {createLabel}
      </a>
    </div>
  </section>
</SiteLayout>
